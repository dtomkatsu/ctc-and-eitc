2025-06-25 14:28:22,557 - INFO - Loading PUMS data...
2025-06-25 14:28:22,558 - ERROR - Error processing PUMS data: [Errno 2] No such file or directory: '../../data/raw/pums/psam_p15.csv'
Traceback (most recent call last):
  File "/Users/dtomkatsu/CascadeProjects/ctc-and-eitc/src/data/process_pums.py", line 237, in main
    person_df, hh_df = load_pums_data()
                       ^^^^^^^^^^^^^^^^
  File "/Users/dtomkatsu/CascadeProjects/ctc-and-eitc/src/data/process_pums.py", line 75, in load_pums_data
    person_df = pd.read_csv(person_file, dtype=DTYPES)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '../../data/raw/pums/psam_p15.csv'
2025-06-25 14:28:54,140 - INFO - Loading PUMS data...
2025-06-25 14:28:54,211 - INFO - Loaded 73971 person records
2025-06-25 14:28:54,221 - INFO - Loaded 32104 household records
2025-06-25 14:28:54,221 - INFO - Cleaning person data...
2025-06-25 14:28:54,239 - ERROR - Error processing PUMS data: data type 'category' not understood
Traceback (most recent call last):
  File "/Users/dtomkatsu/CascadeProjects/ctc-and-eitc/src/data/process_pums.py", line 242, in main
    person_clean = clean_person_data(person_df)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dtomkatsu/CascadeProjects/ctc-and-eitc/src/data/process_pums.py", line 153, in clean_person_data
    ).astype('category')
      ^^^^^^^^^^^^^^^^^^
TypeError: data type 'category' not understood
2025-06-25 14:29:10,321 - INFO - Loading PUMS data...
2025-06-25 14:29:10,385 - INFO - Loaded 73971 person records
2025-06-25 14:29:10,394 - INFO - Loaded 32104 household records
2025-06-25 14:29:10,394 - INFO - Cleaning person data...
2025-06-25 14:29:10,418 - INFO - Cleaning household data...
2025-06-25 14:29:10,419 - ERROR - Error processing PUMS data: 'ADJINC'
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'ADJINC'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/dtomkatsu/CascadeProjects/ctc-and-eitc/src/data/process_pums.py", line 244, in main
    hh_clean = clean_household_data(hh_df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dtomkatsu/CascadeProjects/ctc-and-eitc/src/data/process_pums.py", line 177, in clean_household_data
    df['HINCP'] = df['HINCP'] * (1000000 / df['ADJINC'])  # ADJINC is in millionths
                                           ~~^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'ADJINC'
2025-06-25 14:29:29,690 - INFO - Loading PUMS data...
2025-06-25 14:29:29,762 - INFO - Loaded 73971 person records
2025-06-25 14:29:29,771 - INFO - Loaded 32104 household records
2025-06-25 14:29:29,771 - INFO - Cleaning person data...
2025-06-25 14:29:29,793 - INFO - Cleaning household data...
2025-06-25 14:29:29,806 - INFO - Merging person and household data...
2025-06-25 14:29:29,813 - INFO - Saving processed data...
2025-06-25 14:29:29,974 - INFO - Saved processed person data to /Users/dtomkatsu/CascadeProjects/ctc-and-eitc/data/processed/pums_person_processed.parquet
2025-06-25 14:29:29,982 - INFO - Saved processed household data to /Users/dtomkatsu/CascadeProjects/ctc-and-eitc/data/processed/pums_household_processed.parquet
2025-06-25 14:29:29,982 - INFO - Data processing completed successfully!
